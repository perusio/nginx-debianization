# -*- mode: nginx; mode: flyspell-prog; ispell-local-dictionary: "american" -*-

### Extremely simple Nginx configuration. A very modest showcase of
### Nginx capabilities and directives.
server {
    listen 80 default; ## listen for IPv4
    listen [::]:80 default ipv6only=on; ## listen for IPv6
    server_name localhost;

    access_log /var/log/nginx/localhost.access.log;

    location / {
        root /var/www;
        index index.html index.htm;
    }

    location /doc {
        root /usr/share;
        autoindex on;

        if ($not_allowed) {
            return 403;
        }
    }

    location /images {
        root /usr/share;
        autoindex on;
    }

    ## Specific error_page for a 404.
    error_page 404 /404.html;

    ## Redirect server error pages to the static page /50x.html.
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /var/www/nginx-default;
    }
    } # server

    ## Another virtual host using mix of IP-, name-, and port-based configuration.
    server {
        listen 127.0.0.1:8000;
        listen somename:8080;
        server_name somename alias another.alias;

        location / {
            root html;
            index index.html index.htm;
        }

} # server

## HTTPS server example.
server {
    listen 443 ssl default_server; # required for session resumption
    server_name localhost;

    ssl_certificate cert.pem;
    ssl_certificate_key  cert.key;

    ssl_session_timeout 10m;

    ## Tweak the SSL settings to your liking.
    ssl_protocols TLSv1;
    ## Stolen from: https://calomel.org/nginx.html.
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:AES
    ssl_prefer_server_ciphers on;
    ## Use Elliptic Curve Diffie-Hellman key agreement with 521 bits.
    ssl_ecdh_curve secp521r1;

    location / {
        root html;
        index index.html index.htm;
    }

} # HTTPS server
